---
import PlotFigure from "../components/PlotFigure.astro";
import Layout from "../layouts/Layout.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../assets/penguins.json";
import Header from "../components/Header.astro";

const adelie = penguins.filter(d => d.species === "Adelie");
const chinstrap = penguins.filter(d => d.species === "Chinstrap");
const gentoo = penguins.filter(d => d.species === "Gentoo");
---

<Layout>
  <Header />

  <main class="container">
    <h1 class="title">Penguins par esp√®ce</h1>

    <nav class="menu">
      <select id="species-hash">
        <option value="#adelie">Adelie</option>
        <option value="#chinstrap">Chinstrap</option>
        <option value="#gentoo">Gentoo</option>
      </select>
    </nav>

    <div class="slider">
      <section id="adelie" class="slide card">
        <h2>Adelie Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(adelie, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Adelie Penguins: {adelie.length}</p>
      </section>

      <section id="chinstrap" class="slide card">
        <h2>Chinstrap Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(chinstrap, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Chinstrap Penguins: {chinstrap.length}</p>
      </section>

      <section id="gentoo" class="slide card">
        <h2>Gentoo Penguins</h2>
        <PlotFigure
          options={{
            marks: [Plot.dot(gentoo, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species" })],
          }}
        />
        <p class="count">Number of Gentoo Penguins: {gentoo.length}</p>
      </section>
    </div>
  </main>

  <script>
    const selectHash = document.querySelector("#species-hash");
    selectHash.addEventListener("change", (evt) => {
      location.hash = (evt.target as HTMLSelectElement).value;
    });

    if (location.hash) {
      selectHash.value = location.hash;
    }
  </script>
</Layout>

<style>
  .container {
    padding: 2rem;
    max-width: 1200px;
    margin: auto;
  }

  .title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    text-align: center;
    background: linear-gradient(90deg, #2563eb, #10b981);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .menu {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
  }

  select {
    padding: 0.25rem 0.5rem;
    font-weight: 500;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    background: white;
    color: #374151;
    transition: border-color 0.2s ease;
  }

  select:hover {
    border-color: #2563eb;
  }

  .slider {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    gap: 2rem;
    padding-bottom: 1rem;
  }

  .slide {
    min-width: 100%;
    flex-shrink: 0;
    scroll-snap-align: start;
  }

  .card {
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  }

  .card h2 {
    margin-bottom: 1rem;
    font-size: 1.5rem;
    color: #2563eb;
  }

  .count {
    margin-top: 1rem;
    font-weight: 500;
    color: #10b981;
  }
</style>
